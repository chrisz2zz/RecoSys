#### LR与CF

- 协同过滤仅利用用户与物品的相互行为信息进行推荐，而逻辑回归模型(LR)综合利用**用户、物品、上下文等多种不同的特征，生成较全面的推荐结果；**
- 相比于**逻辑回归和矩阵分解利用用户和物品的相似度进行推荐，逻辑回归将推荐问题看为分类问题，通过预测正样本的概率对物品进行排序；**
- 逻辑回归模型**将推荐问题转换成了点击率(Click Through Rate, CTR)预估问题**

#### 基于LR的推荐流程

- 将用户的多特征，例如年龄、性别、物品属性等信息转换为**数值型特征向量**；
- 确定逻辑回归模型的优化目标（以优化”点击率“为例），利用已有数据对模型进行训练，确定模型参数；
- 在模型服务阶段，将特征向量输入模型，经过模型推断，得到用户”点击“物品的概率；
- 利用”点击“概率对所有候选物品进行排序，得到推荐列表；
- 基于逻辑回归的推荐过程的重点：**利用样本的特征向量进行模型训练和在线推断。**

#### LR的数学形式

- 逻辑回归模型的推断过程如下：
  - 将特征向量$x = (x_1,x_2,...x_n)^T$作为模型的输入；
  - 通过对各特征赋予相应的权重向量$(w_1,w_2,...,w_{n})$，来表示各特征的重要性差异，将各特征进行加权求和，得到$x^Tw$
  - 将$x^Tw$输入sigmoid函数，映射至0-1的区间，得到最终的点击率

$$
\mathrm{CTR}=\frac{1}{1+\exp \left(-(w . x + b) \right)}
$$

- 对于标准的逻辑回归模型来说，要确定的参数就是**特征向量相应的权重向量**w。

#### LR的训练方法

常用的：**梯度下降法**、牛顿法、拟牛顿法

##### 梯度下降法介绍

<img src="https://blog-1258986886.cos.ap-beijing.myqcloud.com/%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0/4-1.jpeg" style="zoom:50%;" />

![](https://blog-1258986886.cos.ap-beijing.myqcloud.com/%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0/4-2.jpeg)

#### LR的优势和局限

![](https://blog-1258986886.cos.ap-beijing.myqcloud.com/%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0/4-3.jpeg)

![](https://blog-1258986886.cos.ap-beijing.myqcloud.com/%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0/4-4.jpeg)

