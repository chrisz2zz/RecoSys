#### 大概思路

- 如何**在没有大量用户数据的情况下**设计个性化推荐系统并且让用户对推荐结果满意从而愿意使用推荐系统， 就是冷启动的问题。
- 冷启动问题主要分为三类：
  - **用户冷启动**：用户冷启动主要解决如何给新用户做个性化推荐的问题。
  - **系统冷启动**：系统冷启动主要解决如何在一个新开发的网站上(还没有用户，也没有用户行为，只有一些物品的信息)设计个性化推荐系统。
  - **物品冷启动**：物品冷启动主要解决如何将新的物品推荐给可能对它感兴趣的用户这一问题。
- 对于这3种不同的冷启动问题，有不同的解决方案。一般来说，可以参考如下解决方案。
- **用户冷启动：**
  - **提供非个性化的推荐**，非个性化推荐的最简单例子就是热门排行榜。
  - 利用用户注册时提供的年龄、性别等数据做**粗粒度的个性化**。
  - 利用用户的社交网络账号登录(需要用户授权)，导入用户在社交网站上的**好友信息**，然后给用户推荐其好友喜欢的物品。
  - 要求用户在**登录时对一些物品进行反馈**，收集用户对这些物品的兴趣信息，然后给用户推荐那些和这些物品相似的物品。
- **物品冷启动：**
  - 对于新加入的物品，可以**利用内容信息**，基于内容的召回，将它们推荐给**喜欢过和它们相似的物品**的用户。
  - 有很多知识图谱可以直接使用，比如电影图谱、书籍图谱等等。**知识图谱蕴含丰富的结构性知识**，虽然冷启动的物品只有有限的交互数据，但是**通过知识图谱可以挖掘到更多的信息**，比如这个电影的演员、导演等等，通过这些关联的信息，也可以推断出哪些用户可能对这个电影感兴趣。
  - 双塔模型：**只在item侧，根据item的属性信息，得到item的embedding**
- **行为冷启动：**
  - 一个用户可能只有很少的购买行为，**在购买这个目标上，该用户是冷启动用户**，但是该用户可能有很多其他行为，比如点击、加购物车等等。**通过利用这些辅助行为也可以帮助目标行为上用户冷启动推荐**
- **Embedding冷启动：**
  - 加入side information
    - 淘宝EGES：没有id Embedding时，可以**通过其他属性的Embedding加权平均得来**
    - 也可以**直接把物品或者用户特征输入到主模型之中**，只要这个主模型能够进行online inference，照样可以解决冷启动问题
    - MetaEmbedding：**提出使用物品（广告）其他特征，通过一个生成器来输出一个ID embedding的初始化值**
  - AirBnb Embedding
    - 新的短租屋上架之后，会**按照新的短租屋和已有短租屋的属性（房屋类型，价格，房间数等等）和地理位置距离，找到三个相似的有Embedding的短租屋，然后取其Embedding的平均**
  - 传统的机器学习
    - **比如利用聚类快速定位新物品所在的cluster，找到相似物品。**
    - **再比如根据用户/物品的特征训练一颗决策树，再把冷启动的用户/物品根据有限的信息分配到决策树的某个分支中去，再根据分支对应的默认列表进行推荐等等。**
- **系统冷启动：**
  - 在系统冷启动时，可以**引入专家的知识**，通过一定的高效方式迅速建立起物品的相关度表。

#### Embedding冷启

##### 问题来源

**为了生成Embedding向量，我们就必须完成整个神经网络的训练**，拿Word2vec来说，必须在Embedding matrix **W**训练完毕、收敛之后，才能够提取对应的Embedding

**这个时候冷启动的问题就来了，如果在模型训练完毕之后，又来了一个新的user或者item。怎么办？**

要**想得到新的Embedding，就必须把这个新的user/item加到网络中去，这就意味着你要更改输入向量的维度，这进一步意味着你要重新训练整个神经网络，但是，由于Embedding层的训练往往是整个网络中参数最大，速度最慢的**，整个训练过程持续几个小时是非常常见的。这个期间，肯定又有新的item产生，难道整个过程就成一个死局了吗？**这个所谓的“死局”就是棘手的Embedding的冷启动问题**

##### 加入 Side information

大多数Embedding方法是建立在用户的行为序列数据基础上的，用户的历史行为越多，训练出的Embedding越准确。但是，用户的历史行为并不是非常容易产生的，特别是购买、完成观看这类高质量的正向行为。也正因如此，如果仅基于历史行为来生成Embedding，必然会造成其覆盖率低下。

**为了尽可能为更多的item和user生成Embedding，把Embedding冷启动这件事情“大事化小”。我们必须加入一些其他类型的特征，典型的用户侧特征是人口属性特征，典型的物品侧特征是一些内容型特征**，我们一般统称**side information**。

理论上来说，任何能够混合不同特征的深度学习模型都可以通过引入side information生成Embedding。例如：**淘宝团队的EGES模型**

<img src="https://blog-1258986886.cos.ap-beijing.myqcloud.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/24-7.png" style="zoom:33%;" />

图中**彩色的部分的Dense Embedding就是不同的特征域对应的Embedding层，每一个Embedding对应着一类特征**，**SI0就是Item id本身，SI1-SIn就是n个所谓的Side Information，比如Item的类别，价格，标签等等**。这些Embedding经过一个加权平均的过程生成这个Item最终的Embedding。

所以当一个Item没有历史行为信息的时候，也就是说没有SI0时，还可以通过其他特征生成其Embedding，这就大大提高了Embedding的覆盖率。而且我们要清楚的是，当**不同特征的Embedding生成好之后，完全可以把组装生成Item Embedding的过程转移到线上，这样就能够彻底解决冷启动的问题，因为只要新的item生成，我们能够拿到它的特征，就能够组装出它的Embedding**

**一个问题：EGES生成Embedding的方式和Word2vec一样吗？我们应该从哪里拿到每个Item的Embedding？**

- eges应该是用最后一层的向量吧，**交叉熵loss之前的那个参数矩阵**，跟word2vec一样；每个item是构造一条样本inference出来的
- 认为是inference出来，然后用最后在各class上的prob distribution做embedding

**问题：eges里面,item 、price、ccate等embedding不是一个向量空间的为什么可以做加权求和？**

- 首先他们确实不在一个向量空间。但问题是他们是在训练阶段加权求和的，所以他们**所有相关的权重都是在统一的objective下训练的。所以可以求和**。如果是几个feature完全单独训练，只在计算时候加和，会有一些问题

**解决冷启动问题也没必要总是执着于从Embedding的角度解决**，因为Embedding也是作为一类特征输入到主推荐模型，或者主CTR预估模型之中的。既然这样，我们也完全可以直接把物品或者用户特征输入到主模型之中，只要这个主模型能够进行online inference，照样可以解决冷启动问题

- Recsys2020上，Amazon Video团队就分享过类似的做法（ 论文地址：[https://dl.acm.org/doi/10.1145/3383313.3411555](https://link.zhihu.com/?target=https%3A//dl.acm.org/doi/10.1145/3383313.3411555)）。他们为了解决新加入视频的冷启动问题，把视频的一些metadata，流行度（popularity），新鲜度等一些列特征输入预测模型之中，即使没有模型提前生成好的Embedding，也照样可以做出“比较靠谱”的预测。

**所以从“信息和模型”这个角度来解决这个问题，大致思路就是“聊胜于无”，整理好冷启动过程中你能获取到的可用的用户或者物品特征，把他们整合进模型，虽然刚开始可能不甚准确，但他们已经是你做出的最好的“菜”了，好过在一张白纸上预测**

**MetaEmbedding**

<img src="https://blog-1258986886.cos.ap-beijing.myqcloud.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/24-8.png" style="zoom:50%;" />

冷启动推荐效果不佳，主要原因在于交互数量少，ID embedding学不好。那么为了更好地学习ID embedding，应该给ID embedding一个不错的初始化值。**MetaEmbedding提出使用物品（广告）其他特征，通过一个生成器来输出一个ID embedding的初始化值**。该方法通过使用已有的物品来模拟冷启动的过程来学习这个生成器，对于每一个新加入的物品，都是用这个生成器预测ID embedding的初始化值，基于这个初始化值再做后续的训练及预测



#### Airbnb采用的冷启动机制

首先肯定是要为大多数已有短租屋生成Embedding，**那么在新的短租屋上架之后，会按照新的短租屋和已有短租屋的属性（房屋类型，价格，房间数等等）和地理位置距离，找到三个相似的有Embedding的短租屋，然后取其Embedding的平均**。

在冷启动机制的选取过程中，我们不应该忘记传统的机器学习模型，**比如利用聚类快速定位新物品所在的cluster，找到相似物品。** 

**再比如根据用户/物品的特征训练一颗决策树，再把冷启动的用户/物品根据有限的信息分配到决策树的某个分支中去，再根据分支对应的默认列表进行推荐等等。**

